#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct Stock {
    char name[50];
    float open, close;
    struct Stock *next;
} Stock;

Stock *head = NULL;

// Add new stock record
void insertStock() {
    char name[50];
    float open, close;
    printf("\nEnter stock name: ");
    scanf("%s", name);
    printf("Enter opening price: ");
    scanf("%f", &open);
    printf("Enter closing price: ");
    scanf("%f", &close);

    Stock *newStock = (Stock*)malloc(sizeof(Stock));
    strcpy(newStock->name, name);
    newStock->open = open;
    newStock->close = close;
    newStock->next = head;
    head = newStock;

    printf("\nStock added successfully!\n");
}

// Display all records
void displayStocks() {
    if (head == NULL) {
        printf("\nNo stock records found!\n");
        return;
    }
    Stock *temp = head;
    printf("\nStock Data:\n");
    printf("-------------------------------\n");
    while (temp != NULL) {
        printf("%s - Opening: %.2f | Closing: %.2f\n", temp->name, temp->open, temp->close);
        temp = temp->next;
    }
    printf("-------------------------------\n");
}

// Find highest and lowest closing price
void findHighLow() {
    if (head == NULL) {
        printf("\nNo records available!\n");
        return;
    }
    float high = head->close, low = head->close;
    Stock *temp = head;
    while (temp != NULL) {
        if (temp->close > high) high = temp->close;
        if (temp->close < low) low = temp->close;
        temp = temp->next;
    }
    printf("\nHighest Closing Price: %.2f\nLowest Closing Price: %.2f\n", high, low);
}

// Calculate average closing price
void averagePrice() {
    if (head == NULL) {
        printf("\nNo records available!\n");
        return;
    }
    float sum = 0;
    int count = 0;
    Stock *temp = head;
    while (temp != NULL) {
        sum += temp->close;
        count++;
        temp = temp->next;
    }
    printf("\nAverage Closing Price: %.2f\n", sum / count);
}

int main() {
    int choice;

    do {
        printf("\n==============================");
        printf("\n  STOCK MARKET ANALYZER MENU");
        printf("\n==============================");
        printf("\n1. Add Stock Record");
        printf("\n2. Display All Stocks");
        printf("\n3. Find Highest & Lowest Price");
        printf("\n4. Calculate Average Price");
        printf("\n5. Exit");
        printf("\nEnter your choice: ");
        scanf("%d", &choice);

        switch (choice) {
            case 1: insertStock(); break;
            case 2: displayStocks(); break;
            case 3: findHighLow(); break;
            case 4: averagePrice(); break;
            case 5: printf("\nExiting program... Goodbye!\n"); break;
            default: printf("\nInvalid choice! Try again.\n");
        }

    } while (choice != 5);

    return 0;
}
